<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
<meta http-equiv="Content-Type" content="text/xhtml;charset=UTF-8"/>
<meta http-equiv="X-UA-Compatible" content="IE=9"/>
<meta name="generator" content="Doxygen 1.8.6"/>
<title>ruuvi.firmware.c: src/tasks/sensors/task_acceleration.h File Reference</title>
<link href="tabs.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="jquery.js"></script>
<script type="text/javascript" src="dynsections.js"></script>
<link href="navtree.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="resize.js"></script>
<script type="text/javascript" src="navtree.js"></script>
<script type="text/javascript">
  $(document).ready(initResizable);
  $(window).load(resizeHeight);
</script>
<link href="search/search.css" rel="stylesheet" type="text/css"/>
<script type="text/javascript" src="search/search.js"></script>
<script type="text/javascript">
  $(document).ready(function() { searchBox.OnSelectItem(0); });
</script>
<link href="doxygen.css" rel="stylesheet" type="text/css" />
</head>
<body>
<div id="top"><!-- do not remove this div, it is closed by doxygen! -->
<div id="titlearea">
<table cellspacing="0" cellpadding="0">
 <tbody>
 <tr style="height: 56px;">
  <td style="padding-left: 0.5em;">
   <div id="projectname">ruuvi.firmware.c
   </div>
   <div id="projectbrief">Ruuvi Firmware for nRF52 sensors</div>
  </td>
 </tr>
 </tbody>
</table>
</div>
<!-- end header part -->
<!-- Generated by Doxygen 1.8.6 -->
<script type="text/javascript">
var searchBox = new SearchBox("searchBox", "search",false,'Search');
</script>
  <div id="navrow1" class="tabs">
    <ul class="tablist">
      <li><a href="index.html"><span>Main&#160;Page</span></a></li>
      <li><a href="modules.html"><span>Modules</span></a></li>
      <li><a href="annotated.html"><span>Data&#160;Structures</span></a></li>
      <li class="current"><a href="files.html"><span>Files</span></a></li>
      <li>
        <div id="MSearchBox" class="MSearchBoxInactive">
        <span class="left">
          <img id="MSearchSelect" src="search/mag_sel.png"
               onmouseover="return searchBox.OnSearchSelectShow()"
               onmouseout="return searchBox.OnSearchSelectHide()"
               alt=""/>
          <input type="text" id="MSearchField" value="Search" accesskey="S"
               onfocus="searchBox.OnSearchFieldFocus(true)" 
               onblur="searchBox.OnSearchFieldFocus(false)" 
               onkeyup="searchBox.OnSearchFieldChange(event)"/>
          </span><span class="right">
            <a id="MSearchClose" href="javascript:searchBox.CloseResultsWindow()"><img id="MSearchCloseImg" border="0" src="search/close.png" alt=""/></a>
          </span>
        </div>
      </li>
    </ul>
  </div>
  <div id="navrow2" class="tabs2">
    <ul class="tablist">
      <li><a href="files.html"><span>File&#160;List</span></a></li>
      <li><a href="globals.html"><span>Globals</span></a></li>
    </ul>
  </div>
</div><!-- top -->
<div id="side-nav" class="ui-resizable side-nav-resizable">
  <div id="nav-tree">
    <div id="nav-tree-contents">
      <div id="nav-sync" class="sync"></div>
    </div>
  </div>
  <div id="splitbar" style="-moz-user-select:none;" 
       class="ui-resizable-handle">
  </div>
</div>
<script type="text/javascript">
$(document).ready(function(){initNavTree('task__acceleration_8h.html','');});
</script>
<div id="doc-content">
<!-- window showing the filter options -->
<div id="MSearchSelectWindow"
     onmouseover="return searchBox.OnSearchSelectShow()"
     onmouseout="return searchBox.OnSearchSelectHide()"
     onkeydown="return searchBox.OnSearchSelectKey(event)">
<a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(0)"><span class="SelectionMark">&#160;</span>All</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(1)"><span class="SelectionMark">&#160;</span>Data Structures</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(2)"><span class="SelectionMark">&#160;</span>Files</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(3)"><span class="SelectionMark">&#160;</span>Functions</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(4)"><span class="SelectionMark">&#160;</span>Variables</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(5)"><span class="SelectionMark">&#160;</span>Typedefs</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(6)"><span class="SelectionMark">&#160;</span>Enumerations</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(7)"><span class="SelectionMark">&#160;</span>Enumerator</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(8)"><span class="SelectionMark">&#160;</span>Macros</a><a class="SelectItem" href="javascript:void(0)" onclick="searchBox.OnSelectItem(9)"><span class="SelectionMark">&#160;</span>Groups</a></div>

<!-- iframe showing the search results (closed by default) -->
<div id="MSearchResultsWindow">
<iframe src="javascript:void(0)" frameborder="0" 
        name="MSearchResults" id="MSearchResults">
</iframe>
</div>

<div class="header">
  <div class="summary">
<a href="#func-members">Functions</a>  </div>
  <div class="headertitle">
<div class="title">task_acceleration.h File Reference</div>  </div>
</div><!--header-->
<div class="contents">

<p>Acceleration and accelerometer related program tasks.  
<a href="#details">More...</a></p>
<div class="textblock"><code>#include &quot;ruuvi_boards.h&quot;</code><br/>
<code>#include &quot;ruuvi_interface_acceleration.h&quot;</code><br/>
<code>#include &quot;ruuvi_driver_error.h&quot;</code><br/>
<code>#include &quot;ruuvi_driver_sensor.h&quot;</code><br/>
<code>#include &quot;ruuvi_interface_gpio_interrupt.h&quot;</code><br/>
<code>#include &quot;ruuvi_interface_log.h&quot;</code><br/>
<code>#include &quot;<a class="el" href="task__communication_8h_source.html">task_communication.h</a>&quot;</code><br/>
</div>
<p><a href="task__acceleration_8h_source.html">Go to the source code of this file.</a></p>
<table class="memberdecls">
<tr class="heading"><td colspan="2"><h2 class="groupheader"><a name="func-members"></a>
Functions</h2></td></tr>
<tr class="memitem:a8a4a41349dd479fa8db0df60fa4fe21d"><td class="memItemLeft" align="right" valign="top">ruuvi_driver_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__acceleration_8h.html#a8a4a41349dd479fa8db0df60fa4fe21d">task_acceleration_init</a> (void)</td></tr>
<tr class="memdesc:a8a4a41349dd479fa8db0df60fa4fe21d"><td class="mdescLeft">&#160;</td><td class="mdescRight">Auto-detects and initializes acceleration sensor in low-power state. Reads supported sensors from board.h and tries to initialize them. Configures the sensor according to defaults in <a class="el" href="application__config_8h.html">application_config.h</a>. Does not enable FiFo or activity interrupts, these must be enabled separately. Initializes SPI bus if accelerometer requires SPI and SPI is not initialized. Initializes I2C bus if accelerometer requires I2C and I2C is not initialized.  <a href="#a8a4a41349dd479fa8db0df60fa4fe21d">More...</a><br/></td></tr>
<tr class="separator:a8a4a41349dd479fa8db0df60fa4fe21d"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a922696c30f5b3b7090cf3caf2bc08441"><td class="memItemLeft" align="right" valign="top">ruuvi_driver_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__acceleration_8h.html#a922696c30f5b3b7090cf3caf2bc08441">task_acceleration_configuration_load</a> (ruuvi_driver_sensor_configuration_t *const config)</td></tr>
<tr class="memdesc:a922696c30f5b3b7090cf3caf2bc08441"><td class="mdescLeft">&#160;</td><td class="mdescRight">loads current configuration of sensor from non-volatile storage. Requires that flash has been initialized.  <a href="#a922696c30f5b3b7090cf3caf2bc08441">More...</a><br/></td></tr>
<tr class="separator:a922696c30f5b3b7090cf3caf2bc08441"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a07ddf5aad381d63ef6a1b16b3d1fa474"><td class="memItemLeft" align="right" valign="top">ruuvi_driver_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__acceleration_8h.html#a07ddf5aad381d63ef6a1b16b3d1fa474">task_acceleration_configuration_store</a> (const ruuvi_driver_sensor_configuration_t *const config)</td></tr>
<tr class="memdesc:a07ddf5aad381d63ef6a1b16b3d1fa474"><td class="mdescLeft">&#160;</td><td class="mdescRight">stores current configuration of sensor into non-volatile storage. Requires that flash has been initialized.  <a href="#a07ddf5aad381d63ef6a1b16b3d1fa474">More...</a><br/></td></tr>
<tr class="separator:a07ddf5aad381d63ef6a1b16b3d1fa474"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:ab21ff51ab50003f845bd0abde9df8456"><td class="memItemLeft" align="right" valign="top">ruuvi_driver_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__acceleration_8h.html#ab21ff51ab50003f845bd0abde9df8456">task_acceleration_data_get</a> (ruuvi_driver_sensor_data_t *const data)</td></tr>
<tr class="memdesc:ab21ff51ab50003f845bd0abde9df8456"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get latest sample from the sensor. Call to this function fetches data from sensor, however it does not trigger sampling. Remember to trigger sampling in case you're in single-shot mode.  <a href="#ab21ff51ab50003f845bd0abde9df8456">More...</a><br/></td></tr>
<tr class="separator:ab21ff51ab50003f845bd0abde9df8456"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a68726c5b80e865a213d765d0273f8fc3"><td class="memItemLeft" align="right" valign="top">ruuvi_driver_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__acceleration_8h.html#a68726c5b80e865a213d765d0273f8fc3">task_acceleration_api_get</a> (<a class="el" href="structtask__communication__api__t.html">task_communication_api_t</a> **api)</td></tr>
<tr class="memdesc:a68726c5b80e865a213d765d0273f8fc3"><td class="mdescLeft">&#160;</td><td class="mdescRight">Get API function pointers from sensor.  <a href="#a68726c5b80e865a213d765d0273f8fc3">More...</a><br/></td></tr>
<tr class="separator:a68726c5b80e865a213d765d0273f8fc3"><td class="memSeparator" colspan="2">&#160;</td></tr>
<tr class="memitem:a4f2797365eb5da91d2d123607d94500c"><td class="memItemLeft" align="right" valign="top">ruuvi_driver_status_t&#160;</td><td class="memItemRight" valign="bottom"><a class="el" href="task__acceleration_8h.html#a4f2797365eb5da91d2d123607d94500c">task_acceleration_movement_count_get</a> (uint8_t *const count)</td></tr>
<tr class="memdesc:a4f2797365eb5da91d2d123607d94500c"><td class="mdescLeft">&#160;</td><td class="mdescRight">return number of movement counts  <a href="#a4f2797365eb5da91d2d123607d94500c">More...</a><br/></td></tr>
<tr class="separator:a4f2797365eb5da91d2d123607d94500c"><td class="memSeparator" colspan="2">&#160;</td></tr>
</table>
<a name="details" id="details"></a><h2 class="groupheader">Detailed Description</h2>
<div class="textblock"><p>Acceleration and accelerometer related program tasks. </p>
<dl class="section author"><dt>Author</dt><dd>Otso Jousimaa </dd></dl>
<dl class="section date"><dt>Date</dt><dd>2019-06-17 </dd></dl>
<dl class="section copyright"><dt>Copyright</dt><dd>Copyright 2019 Ruuvi Innovations. This project is released under the BSD-3-Clause License. </dd></dl>

<p>Definition in file <a class="el" href="task__acceleration_8h_source.html">task_acceleration.h</a>.</p>
</div><h2 class="groupheader">Function Documentation</h2>
<a class="anchor" id="a68726c5b80e865a213d765d0273f8fc3"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ruuvi_driver_status_t task_acceleration_api_get </td>
          <td>(</td>
          <td class="paramtype"><a class="el" href="structtask__communication__api__t.html">task_communication_api_t</a> **&#160;</td>
          <td class="paramname"><em>api</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get API function pointers from sensor. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">api</td><td>pointer to a pointer to a struct of sensor api functions. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>RUUVI_DRIVER_SUCCESS</code> if sensor API functions could be set up </dd>
<dd>
<code>RUUVI_DRIVER_ERROR_NULL</code> if given pointer to api was null </dd>
<dd>
<code>RUUVI_DRIVER_ERROR_INVALID_STATE</code> if sensor was not initialized </dd></dl>

</div>
</div>
<a class="anchor" id="a922696c30f5b3b7090cf3caf2bc08441"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ruuvi_driver_status_t task_acceleration_configuration_load </td>
          <td>(</td>
          <td class="paramtype">ruuvi_driver_sensor_configuration_t *const&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>loads current configuration of sensor from non-volatile storage. Requires that flash has been initialized. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">config</td><td>configuration loaded from flash, or application defaults were not found. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RUUVI_DRIVER_SUCCESS if configuration was loaded from flash. </dd>
<dd>
RUUVI_DRIVER_ERROR_NULL if config is NULL </dd>
<dd>
RUUVI_DRIVER_ERROR_INVALID_STATE if flash is not initialized, and populate config with application defaults. </dd>
<dd>
RUUVI_DRIVER_ERROR_NOT_FOUND if flash is not initialized, and populate config with application defaults. </dd></dl>

</div>
</div>
<a class="anchor" id="a07ddf5aad381d63ef6a1b16b3d1fa474"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ruuvi_driver_status_t task_acceleration_configuration_store </td>
          <td>(</td>
          <td class="paramtype">const ruuvi_driver_sensor_configuration_t *const&#160;</td>
          <td class="paramname"><em>config</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>stores current configuration of sensor into non-volatile storage. Requires that flash has been initialized. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">config</td><td>configuration to be stored. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd>RUUVI_DRIVER_SUCCESS if configuration was stored to flash. </dd>
<dd>
RUUVI_DRIVER_ERROR_NULL if config is NULL </dd>
<dd>
RUUVI_DRIVER_ERROR_INVALID_STATE if flash is not initialized. </dd></dl>

</div>
</div>
<a class="anchor" id="ab21ff51ab50003f845bd0abde9df8456"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ruuvi_driver_status_t task_acceleration_data_get </td>
          <td>(</td>
          <td class="paramtype">ruuvi_driver_sensor_data_t *const&#160;</td>
          <td class="paramname"><em>data</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Get latest sample from the sensor. Call to this function fetches data from sensor, however it does not trigger sampling. Remember to trigger sampling in case you're in single-shot mode. </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[in]</td><td class="paramname">data</td><td>structure which will be filled with acceleration data. </td></tr>
  </table>
  </dd>
</dl>
<dl class="section return"><dt>Returns</dt><dd><code>RUUVI_DRIVER_SUCCESS</code> on success </dd>
<dd>
<code>RUUVI_DRIVER_ERROR_NULL</code> if <code>data</code> is <code>NULL</code> </dd>
<dd>
<code>RUUVI_DRIVER_ERROR_INVALID_STATE</code> if accelerometer is not initialize. </dd></dl>

<p>Definition at line <a class="el" href="task__acceleration_8c_source.html#l00081">81</a> of file <a class="el" href="task__acceleration_8c_source.html">task_acceleration.c</a>.</p>

</div>
</div>
<a class="anchor" id="a8a4a41349dd479fa8db0df60fa4fe21d"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ruuvi_driver_status_t task_acceleration_init </td>
          <td>(</td>
          <td class="paramtype">void&#160;</td>
          <td class="paramname"></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>Auto-detects and initializes acceleration sensor in low-power state. Reads supported sensors from board.h and tries to initialize them. Configures the sensor according to defaults in <a class="el" href="application__config_8h.html">application_config.h</a>. Does not enable FiFo or activity interrupts, these must be enabled separately. Initializes SPI bus if accelerometer requires SPI and SPI is not initialized. Initializes I2C bus if accelerometer requires I2C and I2C is not initialized. </p>
<dl class="section return"><dt>Returns</dt><dd><code>RUUVI_DRIVER_SUCCESS</code> on success. </dd>
<dd>
<code>RUUVI_DRIVER_ERROR_NOT_FOUND</code> if not suitable accelerometer is found. </dd>
<dd>
error code from driver if configuration fails </dd></dl>

<p>Definition at line <a class="el" href="task__acceleration_8c_source.html#l00037">37</a> of file <a class="el" href="task__acceleration_8c_source.html">task_acceleration.c</a>.</p>

</div>
</div>
<a class="anchor" id="a4f2797365eb5da91d2d123607d94500c"></a>
<div class="memitem">
<div class="memproto">
      <table class="memname">
        <tr>
          <td class="memname">ruuvi_driver_status_t task_acceleration_movement_count_get </td>
          <td>(</td>
          <td class="paramtype">uint8_t *const&#160;</td>
          <td class="paramname"><em>count</em></td><td>)</td>
          <td></td>
        </tr>
      </table>
</div><div class="memdoc">

<p>return number of movement counts </p>
<dl class="params"><dt>Parameters</dt><dd>
  <table class="params">
    <tr><td class="paramdir">[out]</td><td class="paramname">count</td><td>number of deteted movements </td></tr>
  </table>
  </dd>
</dl>

<p>Definition at line <a class="el" href="task__acceleration_8c_source.html#l00104">104</a> of file <a class="el" href="task__acceleration_8c_source.html">task_acceleration.c</a>.</p>

</div>
</div>
</div><!-- contents -->
</div><!-- doc-content -->
<!-- start footer part -->
<div id="nav-path" class="navpath"><!-- id is needed for treeview function! -->
  <ul>
    <li class="navelem"><a class="el" href="dir_68267d1309a1af8e8297ef4c3efbcdba.html">src</a></li><li class="navelem"><a class="el" href="dir_b118c466441e8db851de69c6796245a3.html">tasks</a></li><li class="navelem"><a class="el" href="dir_c450b108e3d99d82b1fadbe7f61bc238.html">sensors</a></li><li class="navelem"><a class="el" href="task__acceleration_8h.html">task_acceleration.h</a></li>
    <li class="footer">Generated by
    <a href="http://www.doxygen.org/index.html">
    <img class="footer" src="doxygen.png" alt="doxygen"/></a> 1.8.6 </li>
  </ul>
</div>
</body>
</html>
